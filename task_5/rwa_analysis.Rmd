---
title: "Task 5"
output:
  html_document:
    df_print: paged
    toc: true
    toc_float: true
---

```{r, message = FALSE}
library(tidyverse)
library(ggplot2)

rw_data <- read_csv("data/clean_data/clean_rwa.csv")
```

# Right-Wing Authoritarianism Survey Response Analysis

### What’s the average RWA score for each gender?

```{r}
rw_data %>%
  group_by(gender) %>%
  summarise(average_rwai_per_gender = mean(avg_rwa, na.rm = TRUE))
```

### What’s the average RWA score for left handed people vs. right handed people.

```{r}
rw_data %>% 
  group_by(handedness) %>% 
  summarise(average_rwai_per_hand_group = mean(avg_rwa, na.rm = TRUE), .groups = 'drop_last')
```
### What’s the average family size for each type of childhood?

- I don't know exactly what this question is asking for

potential answer 1:

```{r}
rw_data %>%
  group_by(family_size) %>%
  summarise(average_rwai_per_family_size = mean(avg_rwa, na.rm = TRUE), .groups = 'drop_last')
  
```


### What’s the average time to take the test for each education level?

```{r}
rw_data %>%
  group_by(education_level) %>% 
  summarise(median(test_elapse_t, na.rm = TRUE), .groups = 'drop_last')
```

```{r}
rw_data %>%
  group_by(education_level) %>% 
  summarise(median(survey_elapse_t, na.rm = TRUE), .groups = 'drop_last')
```

```{r}
avg_time_per_ed_level_tibble <- rw_data %>% 
  group_by(education_level) %>% 
  summarise(avg_time_per_ed_level = median(test_elapse_t, na.rm = TRUE), .groups = 'drop_last') %>%
  drop_na()
```

Create a plot of results of question 4.

```{r}
positions <- c("less than high school", "high school", "university degree", "graduate degree")

ggplot() +
  geom_col(data = avg_time_per_ed_level_tibble, aes(x = education_level, y = avg_time_per_ed_level), colour = "black", fill = "grey") +
  scale_x_discrete(limits = positions) +
  ylim(0,400) +
  ggtitle("Level of education compared with the average time to complete the survey")
```

### Average RWA score for people aged

What’s the average RWA score for people aged

```{r}
avg_per_age_band <- rw_data %>%
  mutate(age_band = case_when(
    age < 18 ~ "under 18",
    age < 26 ~ "18-25",
    age < 41 ~ "26-40",
    age < 61 ~ "41-60",
    age >= 61 ~ "61+"
  )) %>%
  select(participant_no, age_band, avg_rwa) %>% 
  group_by(age_band) %>% 
  summarise(avg_rwa_for_age_band = mean(avg_rwa, na.rm = TRUE), .groups = 'drop_last')
```

```{r}
positions <- c("under 18", "18-25", "26-40", "41-60", "61+")

ggplot() +
  geom_point(data = avg_per_age_band, aes(x = age_band, y = avg_rwa_for_age_band)) +
  scale_x_discrete(limits = positions) +
  ylim(0,10) +
  ggtitle("Right wing score vs age")
```

```{r}
avg_rwa_per_country <- rw_data %>% 
  group_by(country_ip) %>% 
  summarise(average_rwa = mean(avg_rwa, na.rm = TRUE), .groups = 'drop_last')
```

```{r}
avg_rwa_per_country_group1 <- rw_data %>% 
  group_by(country_ip) %>% 
  summarise(average_rwa = mean(avg_rwa, na.rm = TRUE), .groups = 'drop_last') %>% 
  filter(country_ip < "FA")

avg_rwa_per_country_group2 <- rw_data %>% 
  group_by(country_ip) %>% 
  summarise(average_rwa = mean(avg_rwa, na.rm = TRUE), .groups = 'drop_last') %>% 
  filter(country_ip >= "FA" & country_ip < "LA")

avg_rwa_per_country_group3 <- rw_data %>% 
  group_by(country_ip) %>% 
  summarise(average_rwa = mean(avg_rwa, na.rm = TRUE), .groups = 'drop_last') %>% 
  filter(country_ip >= "LA" & country_ip < "SA")

avg_rwa_per_country_group4 <- rw_data %>% 
  group_by(country_ip) %>% 
  summarise(average_rwa = mean(avg_rwa, na.rm = TRUE), .groups = 'drop_last') %>% 
  filter(country_ip >= "SA")
```

```{r}

ggplot() +
  geom_col(data = avg_rwa_per_country_group4, aes(x = country_ip, y = average_rwa), colour = "black", fill = "grey") +
  ylim(0,10) +
  ggtitle("Right wing score vs country") +
  theme(axis.text.x = element_text(angle = 90, hjust = 1)) + 
  coord_flip()
```

```{r}

ggplot() +
  geom_col(data = avg_rwa_per_country_group3, aes(x = country_ip, y = average_rwa), colour = "black", fill = "grey") +
  ylim(0,10) +
  ggtitle("Right wing score vs country") +
  theme(axis.text.x = element_text(angle = 90, hjust = 1)) + 
  coord_flip()
```

```{r}

ggplot() +
  geom_col(data = avg_rwa_per_country_group2, aes(x = country_ip, y = average_rwa), colour = "black", fill = "grey") +
  ylim(0,10) +
  ggtitle("Right wing score vs country") +
  theme(axis.text.x = element_text(angle = 90, hjust = 1)) + 
  coord_flip()
```
```{r}
ggplot() +
  geom_col(data = avg_rwa_per_country_group1, aes(x = country_ip, y = average_rwa), colour = "black", fill = "grey") +
  ylim(0,10) +
  ggtitle("Right wing score vs country") +
  theme(axis.text.x = element_text(angle = 90, hjust = 1)) + 
  coord_flip()
```

